---
title: Styling The Blog
slug: /blog/styling-the-blog
date: "2020-09-28T11:16:00"
description: "I added styled-components! With this comes React Hooks, ways to store data locally, and much more."
---

import DarkToggle from 'components/DarkToggle'
import { BorderBox } from 'components/styles'

Previously, this blog was pretty boring. It definitely needed some sprucing up.

So I decided to add [styled components](https://styled-components.com) and react hooks. These together, add color and shape most of the website.

The first thing I needed for this site was dark mode. As a programmer, *EVERYTHING* is darkmode. With the help of [Janosh Riebesell](https://github.com/janosh/blog), I started implementing some different styling techniques.

This React Hook relies on
- `localStorage` to save user preference
- a custom event bus for multiple call sites to `useDarkMode`
- CSS properties for each color theme

<BorderBox><DarkToggle /></BorderBox>



```js:title=src/hooks/useDarkMode.js
import { useLocalStorage, useMediaQuery } from 'hooks'
import { useEffect, useCallback } from 'react'
import {
  COLOR_MODE_KEY,
  INITIAL_COLOR_MODE_CSS_PROP,
  MODE_COLORS,
} from 'utils/constants'

const setBodyColors = mode => {
  for (const [name, colorByMode] of Object.entries(MODE_COLORS)) {
    document.body.style.setProperty(`--color-${name}`, colorByMode[mode])
  }
}

export const useDarkMode = () => {
  const [colorMode, setLSColorMode] = useLocalStorage(COLOR_MODE_KEY)

  // If the user prefers to use dark mode from a media query
  const prefersDarkFromMQ = useMediaQuery(
    `(prefers-color-scheme: dark)`,
    useCallback(
      prefersDark => setBodyColors(prefersDark ? `dark` : `light`), []
    )
  )
  
  // The useDarkMode initialization is in useEffect to exclude it from server
  // -side rendering. This will run on the client after React hydration. The 
  // colors are set in gatsby-ssr, before the React component tree mounts.
  useEffect(() => {
    const initialColorMode = document.body.style.getPropertyValue(
      INITIAL_COLOR_MODE_CSS_PROP
    )
    setLSColorMode(initialColorMode)
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [])

  function setColorMode(newValue) {
    setLSColorMode(newValue)

    // `osPref` is a valid value for persistance, but this value is not a color
    // mode. This value must be reassigned.
    if (newValue === `osPref`) {
      newValue = prefersDarkFromMQ ? `dark` : `light`
    }

    setBodyColors(newValue)
  }

  return [colorMode, setColorMode]
}
```